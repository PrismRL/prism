<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<template id="tmpl_gotoTop"><div id="gotoTop">
  <button>Back to top</button>
</div></template>
    <title>Inventory &#8212; Prism  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=266695fe" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=a1f6949c" />
    <link rel="stylesheet" type="text/css" href="../_static/lua.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/terminal.css?v=ed51fc71" />
    <link rel="stylesheet" type="text/css" href="../_static/goto-top/style.css?v=c152bd81" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/goto-top/main.js?v=69fc67a6"></script>
    <link rel="icon" href="../_static/prism.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Queries" href="query.html" />
    <link rel="prev" title="Collision" href="collision.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="inventory">
<h1>Inventory<a class="headerlink" href="#inventory" title="Link to this heading">¶</a></h1>
<p>Many roguelikes require players to pick up and drop items. Prism provides a flexible inventory system using components and actions. Here’s how to set one up:</p>
<p>First, define which objects can be placed into an inventory using a simple tag component. This is a good place to add volume, weight, and other properties an item might have in the future.</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">--- @class ItemComponent : Component, IQueryable</span>
<span class="kd">local</span> <span class="n">ItemComponent</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Component</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;ItemComponent&quot;</span><span class="p">)</span>
<span class="n">ItemComponent</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Item&quot;</span>

<span class="kr">return</span> <span class="n">ItemComponent</span>
</pre></div>
</div>
<p>Next, define an Inventory component that uses an <a class="reference internal" href="../reference/prism/core/actorstorage.html#lua-ActorStorage" title="ActorStorage"><code class="xref lua lua-class docutils literal notranslate"><span class="pre">ActorStorage</span></code></a> to track contained items. Items are removed from the level when picked up, and restored when dropped:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">--- @class InventoryComponent : Component, IQueryable</span>
<span class="kd">local</span> <span class="n">InventoryComponent</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Component</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;InventoryComponent&quot;</span><span class="p">)</span>
<span class="n">InventoryComponent</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Inventory&quot;</span>

<span class="kr">function</span> <span class="nc">InventoryComponent</span><span class="p">:</span><span class="nf">__new</span><span class="p">()</span>
    <span class="n">self</span><span class="p">.</span><span class="n">inventory</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">ActorStorage</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryComponent</span><span class="p">:</span><span class="nf">query</span><span class="p">(...)</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">inventory</span><span class="p">:</span><span class="n">query</span><span class="p">(...)</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryComponent</span><span class="p">:</span><span class="nf">hasItem</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">inventory</span><span class="p">:</span><span class="n">hasActor</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryComponent</span><span class="p">:</span><span class="nf">addItem</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="nb">assert</span><span class="p">(</span><span class="n">actor</span><span class="p">:</span><span class="n">hasComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Item</span><span class="p">))</span>
    <span class="n">self</span><span class="p">.</span><span class="n">inventory</span><span class="p">:</span><span class="n">addActor</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryComponent</span><span class="p">:</span><span class="nf">removeItem</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">inventory</span><span class="p">:</span><span class="n">removeActor</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">InventoryComponent</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should only call <code class="docutils literal notranslate"><span class="pre">addItem</span></code> or <code class="docutils literal notranslate"><span class="pre">removeItem</span></code> from <strong>inside an action</strong>! Never mutate level state outside of actions!</p>
</div>
<section id="pickup-and-drop-actions">
<h2>Pickup and Drop Actions<a class="headerlink" href="#pickup-and-drop-actions" title="Link to this heading">¶</a></h2>
<p>Define a Pickup action that removes the item from the level and adds it to the actor’s inventory:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">PickupTarget</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Target</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;PickupTarget&quot;</span><span class="p">)</span>

<span class="kr">function</span> <span class="nc">PickupTarget</span><span class="p">:</span><span class="nf">validate</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">targetObject</span><span class="p">)</span>
    <span class="kr">return</span>
        <span class="n">targetObject</span><span class="p">:</span><span class="n">is</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">Actor</span><span class="p">)</span> <span class="ow">and</span>
        <span class="n">targetObject</span><span class="p">:</span><span class="n">hasComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Item</span><span class="p">)</span> <span class="ow">and</span>
        <span class="n">owner</span><span class="p">:</span><span class="n">getRange</span><span class="p">(</span><span class="n">targetObject</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
        <span class="ow">not</span> <span class="n">owner</span><span class="p">:</span><span class="n">expectComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">):</span><span class="n">hasItem</span><span class="p">(</span><span class="n">targetObject</span><span class="p">)</span>
<span class="kr">end</span>

<span class="c1">--- @class PickupAction : Action</span>
<span class="c1">--- @field name string</span>
<span class="c1">--- @field targets Target[]</span>
<span class="kd">local</span> <span class="n">Pickup</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Action</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;PickupAction&quot;</span><span class="p">)</span>
<span class="n">Pickup</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;pickup&quot;</span>
<span class="n">Pickup</span><span class="p">.</span><span class="n">targets</span> <span class="o">=</span> <span class="p">{</span> <span class="n">PickupTarget</span> <span class="p">}</span>
<span class="n">Pickup</span><span class="p">.</span><span class="n">requiredComponents</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span>
    <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">function</span> <span class="nc">Pickup</span><span class="p">:</span><span class="nf">canPerform</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="kr">return</span> <span class="kc">true</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">Pickup</span><span class="p">:</span><span class="nf">perform</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">inventory</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">owner</span><span class="p">:</span><span class="n">expectComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">)</span>
    <span class="n">level</span><span class="p">:</span><span class="n">removeActor</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">inventory</span><span class="p">:</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">Pickup</span>
</pre></div>
</div>
<p>Define a Drop action that removes the item from the inventory and places it into the level at the actor’s location:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">DropTarget</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Target</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;DropTarget&quot;</span><span class="p">)</span>

<span class="kr">function</span> <span class="nc">DropTarget</span><span class="p">:</span><span class="nf">validate</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">targetObject</span><span class="p">)</span>
    <span class="kr">return</span>
        <span class="n">targetObject</span><span class="p">:</span><span class="n">is</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">Actor</span><span class="p">)</span> <span class="ow">and</span>
        <span class="n">targetObject</span><span class="p">:</span><span class="n">hasComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Item</span><span class="p">)</span> <span class="ow">and</span>
        <span class="n">owner</span><span class="p">:</span><span class="n">expectComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">):</span><span class="n">hasItem</span><span class="p">(</span><span class="n">targetObject</span><span class="p">)</span>
<span class="kr">end</span>

<span class="c1">--- @class DropAction : Action</span>
<span class="c1">--- @field name string</span>
<span class="c1">--- @field targets Target[]</span>
<span class="kd">local</span> <span class="n">Drop</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Action</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;DropAction&quot;</span><span class="p">)</span>
<span class="n">Drop</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;drop&quot;</span>
<span class="n">Drop</span><span class="p">.</span><span class="n">targets</span> <span class="o">=</span> <span class="p">{</span> <span class="n">DropTarget</span> <span class="p">}</span>
<span class="n">Drop</span><span class="p">.</span><span class="n">requiredComponents</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span>
    <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">function</span> <span class="nc">Drop</span><span class="p">:</span><span class="nf">canPerform</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="kr">return</span> <span class="kc">true</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">Drop</span><span class="p">:</span><span class="nf">perform</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">inventory</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">owner</span><span class="p">:</span><span class="n">expectComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">)</span>
    <span class="n">inventory</span><span class="p">:</span><span class="n">removeItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="c1">-- it&#39;s safe to change the position of an actor outside of a level!</span>
    <span class="c1">--- @diagnostic disable-next-line</span>
    <span class="n">item</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">owner</span><span class="p">:</span><span class="n">getPosition</span><span class="p">()</span>

    <span class="n">level</span><span class="p">:</span><span class="n">addActor</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">Drop</span>
</pre></div>
</div>
</section>
<section id="keybindings">
<h2>Keybindings<a class="headerlink" href="#keybindings" title="Link to this heading">¶</a></h2>
<p>To allow players to interact with their inventory, add keybindings for pickup and inventory access in your <code class="docutils literal notranslate"><span class="pre">keybindingschema.lua</span></code>:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;pickup&quot;</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Pickup an item on the tile you&#39;re standing on.&quot;</span> <span class="p">},</span>
<span class="p">{</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;inventory&quot;</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Open inventory.&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="handling-pickup-input">
<h2>Handling Pickup Input<a class="headerlink" href="#handling-pickup-input" title="Link to this heading">¶</a></h2>
<p>Now that you’ve defined the keybinding and action, handle the <code class="docutils literal notranslate"><span class="pre">pickup</span></code> input inside your levelstate’s keypressed function. This example queries for an item on the same tile as the player using the Senses component, creates a Pickup action, and sets it as the decision:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;pickup&quot;</span> <span class="kr">then</span>
    <span class="kd">local</span> <span class="n">senses</span> <span class="o">=</span> <span class="n">owner</span><span class="p">:</span><span class="n">getComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Senses</span><span class="p">)</span>
    <span class="kr">if</span> <span class="n">senses</span> <span class="kr">then</span>
        <span class="kd">local</span> <span class="n">query</span> <span class="o">=</span> <span class="n">senses</span><span class="p">:</span><span class="n">query</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Item</span><span class="p">)</span>
            <span class="p">:</span><span class="n">at</span><span class="p">(</span><span class="n">owner</span><span class="p">:</span><span class="n">getPosition</span><span class="p">():</span><span class="n">decompose</span><span class="p">())</span>

        <span class="kd">local</span> <span class="n">item</span> <span class="o">=</span> <span class="n">query</span><span class="p">:</span><span class="n">gather</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="kr">if</span> <span class="n">item</span> <span class="kr">then</span>
            <span class="kd">local</span> <span class="n">pickup</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">actions</span><span class="p">.</span><span class="n">Pickup</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="p">{</span><span class="n">item</span><span class="p">})</span>
            <span class="kr">if</span> <span class="n">pickup</span><span class="p">:</span><span class="n">canPerform</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">level</span><span class="p">)</span> <span class="kr">then</span>
            <span class="n">decision</span><span class="p">:</span><span class="n">setAction</span><span class="p">(</span><span class="n">pickup</span><span class="p">)</span>
            <span class="kr">end</span>
        <span class="kr">end</span>
    <span class="kr">end</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>This approach ensures the action is only triggered when a valid item is on the player’s current tile and the action can legally be performed.</p>
</section>
<section id="inventory-state">
<h2>Inventory State<a class="headerlink" href="#inventory-state" title="Link to this heading">¶</a></h2>
<p>Once players can pick up and drop items, they’ll need a way to view and interact with their inventory. Below is a <strong>very basic</strong> example of a custom <a class="reference internal" href="../reference/spectrum/gamestates/gamestate.html#lua-GameState" title="GameState"><code class="xref lua lua-class docutils literal notranslate"><span class="pre">GameState</span></code></a> that does just that.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This UI is intentionally primitive and meant only as a <strong>minimal working example</strong>. It supports letter-based selection and dropping, but lacks many usability features like scrolling, item descriptions, or a grid layout.</p>
</div>
<p>Here’s the inventory state code:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">keybindings</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;keybindingschema&quot;</span>

<span class="c1">--- @class InventoryState : GameState</span>
<span class="kd">local</span> <span class="n">InventoryState</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">.</span><span class="n">GameState</span><span class="p">:</span><span class="n">extend</span> <span class="s2">&quot;InventoryState&quot;</span>

<span class="c1">--- @param decision ActionDecision</span>
<span class="c1">--- @param level Level</span>
<span class="c1">--- @param inventory InventoryComponent</span>
<span class="kr">function</span> <span class="nc">InventoryState</span><span class="p">:</span><span class="nf">__new</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">inventory</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">decision</span> <span class="o">=</span> <span class="n">decision</span>
    <span class="n">self</span><span class="p">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
    <span class="n">self</span><span class="p">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">.</span><span class="n">inventory</span><span class="p">:</span><span class="n">getAllActors</span><span class="p">()</span>
    <span class="n">self</span><span class="p">.</span><span class="n">letters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="kr">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">self</span><span class="p">.</span><span class="n">items</span> <span class="kr">do</span>
        <span class="n">self</span><span class="p">.</span><span class="n">letters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">string.char</span><span class="p">(</span><span class="mi">96</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="c1">-- a, b, c, ...</span>
    <span class="kr">end</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryState</span><span class="p">:</span><span class="nf">draw</span><span class="p">()</span>
    <span class="n">love</span><span class="p">.</span><span class="n">graphics</span><span class="p">.</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inventory:&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">items</span><span class="p">)</span> <span class="kr">do</span>
        <span class="kd">local</span> <span class="n">letter</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">letters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">love</span><span class="p">.</span><span class="n">graphics</span><span class="p">.</span><span class="nb">print</span><span class="p">((</span><span class="s2">&quot;[%s] %s&quot;</span><span class="p">):</span><span class="n">format</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">name</span><span class="p">),</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kr">end</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">InventoryState</span><span class="p">:</span><span class="nf">keypressed</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="c1">-- Convert pressed key to inventory index</span>
    <span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">letter</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">letters</span><span class="p">)</span> <span class="kr">do</span>
        <span class="kr">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">letter</span> <span class="kr">then</span>
            <span class="kd">local</span> <span class="n">pressedItem</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="kd">local</span> <span class="n">drop</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">actions</span><span class="p">.</span><span class="n">Drop</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">decision</span><span class="p">.</span><span class="n">actor</span><span class="p">,</span> <span class="p">{</span> <span class="n">pressedItem</span> <span class="p">})</span>
            <span class="kr">if</span> <span class="n">drop</span><span class="p">:</span><span class="n">canPerform</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">level</span><span class="p">)</span> <span class="kr">then</span>
            <span class="n">self</span><span class="p">.</span><span class="n">decision</span><span class="p">:</span><span class="n">setAction</span><span class="p">(</span><span class="n">drop</span><span class="p">)</span>
            <span class="kr">end</span>

            <span class="n">self</span><span class="p">.</span><span class="n">manager</span><span class="p">:</span><span class="n">pop</span><span class="p">()</span>
            <span class="kr">return</span>
        <span class="kr">end</span>
    <span class="kr">end</span>

    <span class="kr">if</span> <span class="n">keybindings</span><span class="p">:</span><span class="n">keypressed</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;inventory&quot;</span> <span class="kr">then</span>
        <span class="n">self</span><span class="p">.</span><span class="n">manager</span><span class="p">:</span><span class="n">pop</span><span class="p">()</span>
    <span class="kr">end</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">InventoryState</span>
</pre></div>
</div>
</section>
<section id="pushing-the-inventory-state">
<h2>Pushing the Inventory State<a class="headerlink" href="#pushing-the-inventory-state" title="Link to this heading">¶</a></h2>
<p>To trigger this state when the player presses the inventory key (like <code class="docutils literal notranslate"><span class="pre">tab</span></code>), you can hook into your <cite>LevelState:keypressed</cite> handler and push the state:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- top of file</span>
<span class="kd">local</span> <span class="n">InventoryState</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;gamestates.MyGameinventorystate&quot;</span>

<span class="p">...</span>

<span class="kr">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;inventory&quot;</span> <span class="kr">then</span>
   <span class="kd">local</span> <span class="n">inventory</span> <span class="o">=</span> <span class="n">owner</span><span class="p">:</span><span class="n">getComponent</span><span class="p">(</span><span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">)</span>

   <span class="kr">if</span> <span class="n">inventory</span> <span class="kr">then</span>
      <span class="n">self</span><span class="p">.</span><span class="n">manager</span><span class="p">:</span><span class="n">push</span><span class="p">(</span><span class="n">InventoryState</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">level</span><span class="p">,</span> <span class="n">inventory</span><span class="p">))</span>
   <span class="kr">end</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>This approach uses the decision and current level to let the inventory state interact with the game world. Any selected item can be turned into a drop action from within the state.</p>
</section>
<section id="creating-an-item">
<h2>Creating an Item<a class="headerlink" href="#creating-an-item" title="Link to this heading">¶</a></h2>
<p>Now that we have an inventory system and actions to interact with it, let’s create a simple item to pick up and drop. Here’s an example actor called <code class="docutils literal notranslate"><span class="pre">Cheese</span></code> that uses the Item component.</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">--- @class CheeseActor : Actor</span>
<span class="kd">local</span> <span class="n">Cheese</span> <span class="o">=</span> <span class="n">prism</span><span class="p">.</span><span class="n">Actor</span><span class="p">:</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;CheeseActor&quot;</span><span class="p">)</span>
<span class="n">Cheese</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Cheese&quot;</span>

<span class="kr">function</span> <span class="nc">Cheese</span><span class="p">:</span><span class="nf">initialize</span><span class="p">()</span>
   <span class="kr">return</span> <span class="p">{</span>
      <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Drawable</span><span class="p">(</span><span class="nb">string.byte</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prism</span><span class="p">.</span><span class="n">Color4</span><span class="p">.</span><span class="n">WHITE</span><span class="p">),</span>
      <span class="n">prism</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="n">Item</span><span class="p">()</span>
   <span class="p">}</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">Cheese</span>
</pre></div>
</div>
<p>This actor has the <code class="docutils literal notranslate"><span class="pre">Item</span></code> component so it can be picked up and placed in inventories. This is a simple example, but you could throw items onto any Actor even NPCs!</p>
<p>You can spawn this actor into your level to test pickups and drops by pressing <code class="docutils literal notranslate"><span class="pre">~</span></code> and using geometer to paint it in.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/prism.png" alt="Logo" />
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=prismrl&repo=prism&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<!--
Taken from the sphinx library theme: https://vsalvino.github.io/sphinx-library/.

MIT License

Copyright (c) 2020 Vince Salvino and contributors.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<script>
  function toggleMode(theme) {
    document.documentElement.setAttribute("data-theme", theme);
    localStorage.setItem("sphinx-terminal-mode", theme);
  }
  var theme = localStorage.getItem("sphinx-terminal-mode");
  if(theme !== null)
    toggleMode(theme);
</script>
<h3>Reading Mode</h3>

<div class="btn-group">
<button class="btn btn-default" type="button" onclick="toggleMode('light');">Light</button>
<button class="btn btn-default" type="button" onclick="toggleMode('sepia');">Sepia</button>
<button class="btn btn-default" type="button" onclick="toggleMode('dark');">Dark</button>
</div>

<noscript>
  <div>
    JavaScript is required to toggle reading modes.
  </div>
</noscript>
<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../architecture-primer.html">Prism’s Architecture: A Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-tos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="collision.html">Collision</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Inventory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pickup-and-drop-actions">Pickup and Drop Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keybindings">Keybindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-pickup-input">Handling Pickup Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inventory-state">Inventory State</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pushing-the-inventory-state">Pushing the Inventory State</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-item">Creating an Item</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="query.html">Queries</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Making a roguelike</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../making-a-roguelike/part1.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../making-a-roguelike/part2.html">Taking flight</a></li>
<li class="toctree-l1"><a class="reference internal" href="../making-a-roguelike/part3.html">Starting Fights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/prism/index.html">Prism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/spectrum/index.html">Spectrum</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="collision.html" title="previous chapter">Collision</a></li>
      <li>Next: <a href="query.html" title="next chapter">Queries</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Matthew Blanchard, LJNIC.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/how-tos/inventory.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>